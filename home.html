

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Home Page</title>
  <link href="style.css" rel="stylesheet" type="text/css" /><link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Phudu:wght@300..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Signika:wght@300..700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
</head>

<body>
  
  <div id="mainn"></div>
  <div class="loaderDiv">
    <div class="loader" id="loader"></div>
  </div>
  <script>




    



    async function homePage() {
      
      try {
        
        const response = await fetch("https://full-stack-6-889f.onrender.com/homePage", {
            method: "GET",
            credentials: "include"
        });
        const result = await response.json();
        
        console.log(result);
        
        
        mainContainer=document.getElementById("mainn");
        for(let i=0;i<result.length;i++){
          let user=i+1;
          let name=result[i].productName;
          let price=result[i].price;
          let detail=result[i].detail;
          let image=result[i].image;
          let createdAt=result[i].createdAt;
          let sales=result [i].sales;
          let doc=result[i].id;
          let date=new Date(createdAt);
          let realDate=date.toLocaleDateString();
          let realTime=date.toLocaleTimeString();

          const inner1=document.createElement("div");
          mainn.appendChild(inner1);
          inner1.classList.add("inner1");

          const seg1=document.createElement("div");
          inner1.appendChild(seg1);
          seg1.classList.add("seg1");

          const imagee=document.createElement("img");
          seg1.appendChild(imagee);
          imagee.classList.add("imagee");
          imagee.src=image;

          const seg2=document.createElement("div");
          inner1.appendChild(seg2);
          seg2.classList.add("seg2");

          const head2=document.createElement("h1");
          seg2.appendChild(head2);
          head2.classList.add("head2");
          head2.textContent=`Name:${name}`;

          const seg3=document.createElement("div");
          inner1.appendChild(seg3);
          seg3.classList.add("seg3");

          const head3=document.createElement("h1");
          seg3.appendChild(head3);
          head3.classList.add("head3");
          head3.textContent=`product detail: ${detail}`;

          const seg4=document.createElement("div");
          inner1.appendChild(seg4);
          seg4.classList.add("seg4");

          const head4=document.createElement("h1");
          seg4.appendChild(head4);
          head4.classList.add("head4");
          head4.textContent=`No.of Sales: ${sales}`;

          const seg5=document.createElement("div");
          inner1.appendChild(seg5);
          seg5.classList.add("seg5");

          const head5=document.createElement("h1");
          seg5.appendChild(head5);
          head5.classList.add("head5");
          head5.textContent=`uploaded at: ${realDate}`;

          const seg6=document.createElement("div");
          inner1.appendChild(seg6);
          seg6.classList.add("seg6");

          const head6=document.createElement("button");
          seg6.appendChild(head6);
          head6.classList.add("head6");
          head6.textContent="BUY NOW";

          head6.addEventListener("click",()=>{
            head6.style.background="rgb(151, 87, 2)";
            head6.style.color="white";
            setTimeout(()=>{
              head6.style.background="rgb(245, 162, 54)";
              head6.style.color="black";
            },1000);
            const loader=document.getElementById("loader");
            loader.style.display="block";
            purchase(doc);
          });

          const seg7=document.createElement("div");
          inner1.appendChild(seg7);
          seg7.classList.add("seg7");

          const head7=document.createElement("h1");
          seg7.appendChild(head7);
          head7.classList.add("head7");
          head7.textContent=`Rs.${price}`;
        }
        const empty=document.createElement("div");
        mainn.appendChild(empty);
        empty.classList.add("empty");

        const box=document.createElement("div");
        mainn.appendChild(box);
        box.classList.add("box");

        const myBtn=document.createElement("button");
        box.appendChild(myBtn);
        myBtn.textContent="My Products";
        myBtn.classList.add("myProductButton");
        myBtn.addEventListener("click",()=>{
          myBtn.style.background="rgb(247, 124, 36)";
          myBtn.style.color="black";
          setTimeout(()=>{
            myBtn.style.background="pink";
            myBtn.style.color="black";
          },1000);
          const loader=document.getElementById("loader");
          loader.style.display="block";
          window.location.href="myProduct.html";
          
          
        });

        const addBtn=document.createElement("button");
        box.appendChild(addBtn);
        addBtn.textContent="Add Your Product";
        addBtn.classList.add("addProductButton");
        addBtn.addEventListener("click",()=>{
          addBtn.style.background="rgb(247, 124, 36)";
          addBtn.style.color="black";
          setTimeout(()=>{
            addBtn.style.background="pink";
            addBtn.style.color="black";
          },1000);
          const loader=document.getElementById("loader");
          loader.style.display="block";
          window.location.href="addProduct.html";
          
          
        });

        const infoBtn=document.createElement("button");
        box.appendChild(infoBtn);
        infoBtn.textContent="Your Details";
        infoBtn.classList.add("infoButton");
        infoBtn.addEventListener("click",()=>{
          infoBtn.style.background="rgb(247, 124, 36)";
          infoBtn.style.color="black";
          setTimeout(()=>{
            infoBtn.style.background="pink";
            infoBtn.style.color="black";
          },1000);
          const loader=document.getElementById("loader");
          loader.style.display="block";
          window.location.href="info.html";
          
          
        });

    } 
    catch (error) {
      
      console.error("Error:", error);
    }
      
}
  homePage();
    async function purchase(a){
      try{
        data={
          docId:a
        }
        const response=await fetch("https://full-stack-6-889f.onrender.com/myPurchase",{
          
          method:"POST",
          headers:{
            
            "Content-Type":"application/json"
          },
          credentials:"include",
          body:JSON.stringify(data)
        });
        const result= await response.text();
        fResult=JSON.parse(result);
        if(fResult=="added increment and myPurchase"){
          alert("Purchased successfully");
          const loader=document.getElementById("loader");
          loader.style.display="none";
        }
        else{
          alert("error,try again");
          const loader=document.getElementById("loader");
          loader.style.display="none";
        }
        
      }
      catch(error){
        console.error(error);
      }
    }
    window.addEventListener("pageshow",()=>{
      const loader=document.getElementById("loader");
      loader.style.display="none";
    });

    
  </script>
</body>

</html>
